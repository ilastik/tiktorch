name: tiktorch-server-env
channels:
  - ilastik-forge
  - pytorch
  - conda-forge
dependencies:
  # - bioimage.spec via submodule
  # - bioimage.core via submodule
  - python=3.7.*=*_cpython
  - numpy=1.19.*
  - grpcio-tools
  - grpcio>=1.31,<=1.40.0
  - marshmallow-union
  - marshmallow=3.12.*
  - protobuf
  - pytest
  - pytest-grpc
  - pyyaml=5.3.*
  - requests
  - ruamel.yaml
  - scikit-learn
  - scipy
  - typing-extensions
  - xarray

  # pytorch
  # remove cpuonly, add cudatoolkit and cudnn for gpu support
  - pytorch=1.10.*
  - inferno=v0.4.*
  # currently it's necessary to force the cpu version, remove
  # torchvision pin when going for gpu
  - torchvision=*=*cpu
  - cpuonly
  # - cudatoolkit >=10.2
  # - cudnn
  # - tochvision

  # tensorflow (1.14 is the latest 1.x version on cf)
  # so far we don't have any 2.x models in the model zoo
  - tensorflow=1.14.*

  # convenient to use bioiamgeio.core tools
  - imageio
  - tqdm
  - typer

  # dev stuff
  - black
  - bump2version
  - flake8
  - isort
  - mypy
  - pre_commit
